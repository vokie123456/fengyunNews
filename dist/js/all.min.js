angular.module("myApp",["ionic","ngRoute","myApp.httpFactory","myApp.slideBox","myApp.tabs","myApp.news","myApp.live","myApp.topic","myApp.mine","myApp.search","myApp.newsDetails","myApp.newsMiddle"]).config(["$stateProvider","$urlRouterProvider","$ionicConfigProvider",function(e,t,o){o.tabs.position("bottom"),o.tabs.style("standard"),o.navBar.alignTitle("center"),e.state("tabs",{url:"/tabs",abstract:!0,templateUrl:"tabs.html",controller:"tabsController"}),t.otherwise("/tabs/news")}]),angular.module("myApp.live",[]).config(["$stateProvider",function(e){e.state("tabs.live",{url:"/live",views:{"tabs-live":{templateUrl:"live.html",controller:"liveController"}}})}]).controller("liveController",["$scope","$timeout","$ionicScrollDelegate","HttpFactory",function(e,t,o,n){e.news={adsArray:[],counter:"",pTitles:[],sublives:[],liveReviews:[]};var i=function(){var t="http://data.live.126.net/livechannel/previewlist.json";e.show(),n.getData(t).then(function(t){e.hide();var o=[];if(t.top.length){for(var n=0;n<t.top.length;n++){var i={title:t.top[n].roomName,imgsrc:t.top[n].image};o.push(i)}e.news.adsArray=o}e.news.counter=t.future.length,e.news.pTitles=t.future,e.news.sublives=t.sublives,e.news.liveReviews=t.live_review})},r=function(){function t(){clearInterval(n),n=setInterval(function(){r+=-10,r%300==0&&(clearInterval(n),r/300<-e.news.counter+1&&(r=0)),i.style.top=r/100+"rem"},20)}function o(){l++,l%240==0&&t(),a=requestAnimationFrame(o)}var n,i=document.querySelector(".pContent"),r=0,l=0,a=requestAnimationFrame(o)};i(),e.doRefresh=function(){i(),e.$broadcast("scroll.refreshComplete")},r(),e.isShowInfinite=!0;var l=2;e.loadingMore=function(){t(function(){url="http://data.live.126.net/livechannel/previewlist/"+l+".json",n.getData(url).then(function(t){l+=1,t=t.live_review,e.news.liveReviews=e.news.liveReviews.concat(t)}),e.$broadcast("scroll.infiniteScrollComplete")},1e3)},e.backTop=function(){o.$getByHandle("liveHandle").anchorScroll()}}]),angular.module("myApp.mine",[]).config(["$stateProvider",function(e){e.state("tabs.mine",{url:"/mine",views:{"tabs-mine":{templateUrl:"mine.html",controller:"mineController"}}})}]).controller("mineController",["$scope",function(e){}]),angular.module("myApp.news",[]).config(["$stateProvider",function(e){e.state("tabs.news",{url:"/news",views:{"tabs-news":{templateUrl:"news.html",controller:"newsController"}}})}]).controller("newsController",["$scope","$state","$location","$timeout","$ionicViewSwitcher","$ionicScrollDelegate","HttpFactory",function(e,t,o,n,i,r,l){function a(t){"special"==e.news.newsListArray[t].skipType?o.path("/newsMiddle/"+e.news.newsListArray[t].skipID):o.path("/newsDetails/"+e.news.newsListArray[t].docid),i.nextDirection("forward")}var s="http://c.m.163.com/nc/topicset/ios/subscribe/manage/listspecial.html";l.getData(s).then(function(t){t=t[Object.keys(t)[0]],e.nameArray=t});var c=document.getElementsByClassName("doSameNews");e.doSomeNews=function(e){for(var t=0;t<c.length;t++)t==e?c[t].style.color="red":c[t].style.color="black";r.$getByHandle("myHandle").anchorScroll()},e.news={newsArray:"",adsArray:[],newsListArrary:[],goToNewsDetails:a};e.slidBox=!0;var d=function(){var t=0,o="http://c.m.163.com/recommend/getSubDocPic?tid=T1348647909107&from=toutiao&offset="+t+"&size=10&fn=1&prog=LMA1&passport=&devId=eW7qcXmjWleAjCxp25EgTBBywawDoVwZiZ9SMikG4cGiOa69wsn%2FdeHaaNGRMr2hIIGNeE0nI41SFrBIaL1THA%3D%3D&lat=DJEPdRawaRYCJZwF3SQobA%3D%3D&lon=7J7OmyytD8SqP0pSV1cJJA%3D%3D";e.show(),e.slidBox=!1,l.getData(o).then(function(t){e.slidBox=!0,e.hide(),t=t[Object.keys(t)[0]];var o=[];if(t[0].ads){for(var n=0;n<t[0].ads.length;n++){var i={title:t[0].ads[n].title,imgsrc:t[0].ads[n].imgsrc};o.push(i)}e.news.adsArray=o}e.news.newsListArray=t.splice(0,1),e.news.newsListArray=t})};d(),e.doRefresh=function(){d(),e.$broadcast("scroll.refreshComplete")},e.isShowInfinite=!0,index=11,e.loadMore=function(){n(function(){s="http://c.m.163.com/recommend/getSubDocPic?tid=T1348647909107&from=toutiao&offset="+index+"&size=10&fn=1&prog=LMA1&passport=&devId=eW7qcXmjWleAjCxp25EgTBBywawDoVwZiZ9SMikG4cGiOa69wsn%2FdeHaaNGRMr2hIIGNeE0nI41SFrBIaL1THA%3D%3D&lat=DJEPdRawaRYCJZwF3SQobA%3D%3D&lon=7J7OmyytD8SqP0pSV1cJJA%3D%3D",l.getData(s).then(function(t){index+=10,t=t[Object.keys(t)[0]],e.news.newsListArray=e.news.newsListArray.concat(t)}),e.$broadcast("scroll.infiniteScrollComplete")},1e3)};var p=document.querySelector(".reversalBtnDiv");e.reversalBtn=function(){p.style.height="87%"},e.backUpBtn=function(){p.style.height=0},e.backTop=function(){r.$getByHandle("newsHandle").anchorScroll()}}]),angular.module("myApp.newsDetails",[]).config(["$stateProvider",function(e){e.state("newsDetails",{url:"/newsDetails/:docid",templateUrl:"newsDetails.html",controller:"newsDetailsController"})}]).controller("newsDetailsController",["$scope","$stateParams","$sce","$location","$ionicLoading","$ionicScrollDelegate","HttpFactory",function(e,t,o,n,i,r,l){e.show=function(){i.show({template:'<ion-spinner icon="ios"></ion-spinner>'})},e.hide=function(){i.hide()},e.newsDetails={detail:"",body:"",docid:""},e.newsDetails.docid=t.docid[0],e.docid1=!1,e.docid2=!1,e.docid3=!1;var a;e.show(),"C"==e.newsDetails.docid||"B"==e.newsDetails.docid||"9"==e.newsDetails.docid?(e.docid1=!0,a="http://c.m.163.com/nc/article/"+t.docid+"/full.html",l.getData(a).then(function(t){e.hide(),t=t[Object.keys(t)[0]],e.newsDetails.detail=t,console.log(t);var n=e.newsDetails.detail;if(n.img&&n.img.length)for(var i=0;i<n.img.length;i++){var r=n.img[i].pixel.split("*")[0];r>=document.body.offsetWidth-30&&(r=document.body.offsetWidth-30);var l="width:"+r+"px",a="<img class='newsImg' style='"+l+"' src="+n.img[i].src+">";n.body=n.body.replace(n.img[i].ref,a)}e.newsDetails.body=o.trustAsHtml(n.body)})):"V"==e.newsDetails.docid?(e.docid2=!0,a="http://c.m.163.com/nc/video/detail/"+t.docid+".html",l.getData(a).then(function(t){e.hide(),console.log(t)})):(e.docid3=!0,e.hide()),e.goBack=function(){window.history.go(-1)},e.backTop=function(){r.$getByHandle("myHandle").anchorScroll()}}]),angular.module("myApp.newsMiddle",[]).config(["$stateProvider",function(e){e.state("newsMiddle",{url:"/newsMiddle/:skipID",templateUrl:"newsMiddle.html",controller:"newsMiddleController"})}]).controller("newsMiddleController",["$scope","$stateParams","$location","$ionicViewSwitcher","$anchorScroll","$ionicScrollDelegate","$ionicLoading","HttpFactory",function(e,t,o,n,i,r,l,a){e.show=function(){l.show({template:'<ion-spinner icon="ios"></ion-spinner>'})},e.hide=function(){l.hide()},e.show();var s="http://c.m.163.com/nc/special/"+t.skipID+".html";a.getData(s).then(function(t){e.hide(),t=t[Object.keys(t)[0]],e.newsMiddle=t,e.newsMiddleArray=t.topics,console.log(t.topics),e.length=t.topics.length}),e.goToNewsDetails=function(t,i){o.path("/newsDetails/"+e.newsMiddleArray[t-1].docs[i].docid),n.nextDirection("forward")},e.goToTitle=function(e){o.hash("item"+e)},e.goToTop=function(){o.hash("top")}}]),angular.module("myApp.search",[]).config(["$stateProvider",function(e){e.state("search",{url:"/search",templateUrl:"search.html",controller:"searchController"})}]).controller("searchController",["$scope","$ionicHistory","HttpFactory",function(e,t,o){var n="http://c.m.163.com/nc/search/hotWord.html";o.getData(n).then(function(t){t=t[Object.keys(t)[0]],e.searchArray=t,console.log(e.searchArray)});var i=document.getElementById("searchInput");e.doSame=function(){i.value=this.searcher.hotWord}}]),angular.module("myApp.tabs",[]).controller("tabsController",["$scope","$ionicLoading",function(e,t){e.show=function(){t.show({template:'<ion-spinner icon="ios"></ion-spinner>'})},e.hide=function(){t.hide()}}]),angular.module("myApp.topic",[]).config(["$stateProvider",function(e){e.state("tabs.topic",{url:"/topic",views:{"tabs-topic":{templateUrl:"topic.html",controller:"topicController"}}})}]).controller("topicController",["$scope","$ionicScrollDelegate","$timeout","HttpFactory",function(e,t,o,n){var i=document.getElementById("iconChange"),r=document.getElementById("iconTransfrom"),l=0;e.iconChange=function(){l++,l%2==1?(i.style.height="70vw",r.style.transform="rotate(180deg)"):(i.style.height="24vw",r.style.transform="rotate(0deg)")},e.doConcern=function(t){e.topic.topicListArray[t].state=!e.topic.topicListArray[t].state},e.topic={topArray:[],topicListArray:[]};var a=function(){var t="http://c.m.163.com/newstopic/list/classification.html";n.getData(t).then(function(t){e.topic.topArray=t.data}),t="http://c.m.163.com/newstopic/list/expert/5YyX5Lqs/0-10.html",n.getData(t).then(function(t){e.topic.topicListArray=t.data.expertList})};a(),e.doRefresh=function(){a(),e.$broadcast("scroll.refreshComplete")},e.isShowInfinite=!0,index=10,e.loadMore=function(){o(function(){var t="http://c.m.163.com/newstopic/list/expert/5YyX5Lqs/"+index+"-10.html";n.getData(t).then(function(t){index+=10,e.topic.topicListArray=e.topic.topicListArray.concat(t.data.expertList)}),e.$broadcast("scroll.infiniteScrollComplete")},1e3)},e.backTop=function(){t.$getByHandle("topicHandle").anchorScroll()}}]),angular.module("myApp.httpFactory",[]).factory("HttpFactory",["$http","$q",function(e,t){return{getData:function(o,n){if(o){var i=t.defer();return o="http://59.110.139.104:3000/wy?myUrl="+encodeURIComponent(o),n=n?n:"GET",e({url:o,method:n,timeout:2e4}).then(function(e){e=e.data,i.resolve(e)},function(e){i.reject(e)}),i.promise}}}}]),angular.module("myApp.slideBox",[]).directive("mgSlideBox",[function(){return{restrict:"E",scope:{sourceArray:"="},templateUrl:"slideBox.html",controller:["$scope","$ionicSlideBoxDelegate","$element",function(e,t,o){e.goToDetailView=function(e){console.log("进入详情页"+e)};var n=o[0].lastElementChild;e.$watch("sourceArray",function(t,o){t&&t.length&&(e.isShowSlideBox=!0,n.innerText=e.sourceArray[0].title,e.slideHasChanged=function(t){n.innerText=e.sourceArray[t].title})}),e.slideHasChanged=function(t){n.innerText=e.sourceArray[t].title},t.$getByHandle("mainSlideBox").enableSlide(!1),e.drag=function(e){t.$getByHandle("mainSlideBox").enableSlide(!1),e.stopPropagation()}}],replace:!0,link:function(e,t,o){}}}]);